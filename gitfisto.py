#!/usr/bin/env python

import git
import os
import argparse
import sys
import tempfile
import subprocess

FISTINO ='''<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="153.03784"
   height="318.46747"
   id="svg2"
   sodipodi:version="0.32"
   inkscape:version="0.48.4 r9939"
   sodipodi:docname="fistino.svg"
   inkscape:output_extension="org.inkscape.output.svg.inkscape"
   version="1.0"
   inkscape:export-filename="D:\Creations\Vectors\Fist.png"
   inkscape:export-xdpi="82.379997"
   inkscape:export-ydpi="82.379997"
   sodipodi:modified="TRUE">
  <defs
     id="defs4">
    <inkscape:path-effect
       effect="skeletal"
       id="path-effect2996"
       is_visible="true"
       pattern="M 0,0 0,10 10,5 z"
       copytype="single_stretched"
       prop_scale="1"
       scale_y_rel="false"
       spacing="0"
       normal_offset="0"
       tang_offset="0"
       prop_units="false"
       vertical_pattern="false"
       fuse_tolerance="0" />
  </defs>
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     gridtolerance="10000"
     guidetolerance="10"
     objecttolerance="10"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="2"
     inkscape:cx="-44.06784"
     inkscape:cy="147.77625"
     inkscape:document-units="px"
     inkscape:current-layer="layer2"
     inkscape:window-width="1920"
     inkscape:window-height="1007"
     inkscape:window-x="0"
     inkscape:window-y="25"
     showgrid="false"
     inkscape:window-maximized="1" />
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:groupmode="layer"
     id="layer2"
     inkscape:label="Strokes"
     style="display:inline"
     transform="translate(-37.977333,2.704058)">
    <flowRoot
       xml:space="preserve"
       style="font-size:6px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Arial;-inkscape-font-specification:Arial"
       id="flowRoot3864"><flowRegion
         id="flowRegion3866"><use
           x="0"
           y="0"
           xlink:href="#path3846"
           id="use3868"
           width="153.03784"
           height="318.46747" /></flowRegion><flowPara
         id="flowPara3870">{{s1}}</flowPara></flowRoot>    <path
       sodipodi:type="arc"
       style="fill:none;fill-opacity:1;stroke:none"
       id="path3846"
       sodipodi:cx="-63"
       sodipodi:cy="161.71747"
       sodipodi:rx="39"
       sodipodi:ry="114.75"
       d="m -24,161.71747 c 0,63.37467 -17.460895,114.75 -39,114.75 -21.539105,0 -39,-51.37533 -39,-114.75 0,-63.374677 17.460895,-114.750002 39,-114.750002 21.539105,0 39,51.375325 39,114.750002 z"
       transform="matrix(0.52802201,-0.59515727,0.43514642,1.1340778,91.871941,-44.631693)" />
    <path
       inkscape:connector-curvature="0"
       style="fill:#999999;fill-opacity:1;fill-rule:evenodd;stroke:none"
       d="m 102.24913,39.842646 c -6.51699,-0.779453 -4.510212,10.428678 -11.058783,5.455054 -0.762481,4.560736 2.544634,9.89682 0.667316,11.196338 -5.785146,1.455582 -8.536222,1.640887 -14.011593,1.038295 -0.299186,-0.602596 -1.860756,-0.231817 -0.157175,-2.438686 0.544402,-0.322008 -0.09599,-1.377316 0.287369,-2.633246 2.927632,-0.896913 2.029798,-1.900819 7.562175,2.301345 0.807323,-0.0068 1.670003,-0.938482 2.057234,-1.638193 -2.228281,-2.783356 -4.352764,-2.385101 -4.447634,-2.885649 -0.140752,-0.742619 2.202626,-0.672015 2.66691,-0.49237 2.42056,0.241836 2.682927,0.101034 2.23837,-1.605228 -0.811743,-2.308663 -0.908057,-1.966514 -1.390158,-2.176274 -2.57727,-0.726437 -2.461844,-0.809953 -3.343365,-0.67843 -4.327603,2.041972 -6.175132,1.825318 -8.939845,3.197529 -0.145757,5.11096 -0.225859,6.492285 0.06248,11.411602 0.210956,1.8386 2.537071,1.678316 4.524552,2.84614 7.939224,1.130076 12.374775,-1.25265 13.851294,2.864648 0.187789,0.850131 1.244872,1.534964 2.370858,2.789524 1.478699,1.647551 3.544181,3.734271 3.907547,3.580241 -1.468785,-4.690019 -2.076226,-5.94129 -3.018567,-8.277199 -0.714284,-2.518449 -1.230459,-4.032202 1.65233,-6.073294 -0.345079,-1.861496 -0.247384,-2.943854 2.174285,-4.876104 -0.443212,-1.694448 0.194516,-1.937373 1.201556,-2.044576 0.42094,-0.04479 0.47791,-0.799439 0.87652,-1.207128 0.83796,-1.003021 1.25762,0.348723 2.71206,3.537468 0.64031,-0.92405 1.31428,-0.650319 1.52327,-1.928321 0.0859,-0.525184 -2.06699,-3.436559 -2.11129,-4.937664 2.63429,-3.720027 -2.62233,-13.807231 -1.85772,-6.325822 z"
       id="path3202"
       sodipodi:nodetypes="ccccccccscccccccccccccsccscc" />
    <path
       inkscape:connector-curvature="0"
       style="fill:#808080;fill-opacity:1;fill-rule:evenodd;stroke:none;opacity:0.58264463"
       d="m 92.185664,2.084689 c -0.408553,1.8089947 1.536254,3.7683149 2.106801,5.6397044 0.570547,1.8713896 1.398622,3.6599776 2.109031,5.0304286 0.710409,1.370452 1.364727,2.411792 1.406021,2.48397 l 4.807753,8.390685 c -0.42056,4.340297 -0.22671,8.301335 2.42539,13.066548 1.23483,1.102889 3.11141,2.366218 5.29571,3.706475 l -0.14802,-3.049578 c -1.8776,-3.052771 -3.42418,-2.367228 -5.17442,-6.159139 -2.02833,-8.432729 1.18978,-5.071813 3.50835,-3.988194 -0.90189,-1.039241 -3.74283,-2.733624 -5.61943,-8.381317 -1.98949,-3.602932 -4.358544,-7.210398 -5.570701,-11.6042612 -0.279374,-1.446024 -0.387762,-2.6366347 -0.290132,-4.2359151 0.09703,-1.5894886 1.484857,-1.5137454 2.729464,-0.7052424 2.249569,2.5709944 3.655269,3.8014285 5.157259,6.6281421 0.1502,1.4070506 -5.420331,-5.7030346 -6.614816,-5.6649058 -0.938092,3.5435171 7.058986,10.8502444 13.569416,12.7376514 1.75539,4.544908 3.00766,8.795169 4.15558,15.582277 0.4052,2.052729 0.56718,3.906437 0.58472,6.18426 0.0182,2.365169 -2.02952,6.331547 -2.54869,9.188235 -0.81409,2.20946 0.18261,5.311628 0.47313,7.521088 0.39911,4.650436 0.68211,3.916735 1.17839,7.83801 -0.23185,4.966815 -2.60073,7.553697 -2.28688,10.100097 0.69736,5.657801 -1.8051,7.887292 -1.21607,10.380395 1.64757,3.366266 2.8172,6.482637 3.4343,11.064849 l 25.64565,60.679878 c 2.24992,7.03217 5.36573,9.27054 10.76817,19.75625 6.12375,14.15239 17.55597,36.40116 19.33731,41.5966 3.52679,11.93793 6.35034,23.14188 7.39252,32.19593 -0.7023,-0.77743 -7.86179,1.37825 -6.42747,1.63731 6.7068,3.74771 8.69198,5.23735 12.7857,12.51661 1.05122,-0.81676 3.05962,-11.34138 5.85547,-18.93048 -1.39047,-2.82267 -1.92064,-3.88836 -3.73456,-6.01085 -7.51489,-7.82544 -8.34359,-13.9886 -9.56661,-29.3188 -8.7584,-18.20125 -18.31262,-35.6067 -28.0124,-52.86658 L 119.99809,80.636597 c 0.91094,-1.770496 1.06217,-2.488689 0.95967,-4.840725 8.03638,-10.222286 0.99562,-22.431458 0.75657,-24.627675 -0.59418,-5.943915 2.34379,-9.76901 2.89908,-13.310327 -0.14466,-1.485693 -0.13069,-2.480075 -0.40396,-4.593 -0.98063,-2.625542 -2.80444,-4.866346 -2.53529,-4.651031 -1.69232,-4.603339 -1.92269,-6.491701 -2.58457,-14.581635 -0.11778,-1.423688 -1.09526,-2.468397 -2.56861,-3.553795 C 105.3946,6.0480071 107.51482,7.4956158 98.865379,-2.6042776 94.461338,-3.2500392 92.747882,-0.65400597 92.185664,2.084689 z"
       id="path3160"
       sodipodi:nodetypes="csccccccccccscccccscccsccccccccccccccccccsccc" />
    <path
       inkscape:connector-curvature="0"
       style="fill:#999999;fill-opacity:1;fill-rule:evenodd;stroke:none;display:inline;opacity:0.84297521"
       d="m 78.296886,3.2483726 c -2.23541,2.0853911 -1.088817,2.1277741 -4.633144,3.6814205 -3.689137,3.5953579 -6.829715,9.2073919 -11.116045,11.7101239 -11.457105,2.220727 -11.146391,3.158864 -18.49466,3.505473 -0.869956,-0.0207 -1.835746,0.779067 -1.856115,2.333759 -0.01672,1.276326 -1.797537,9.605172 -3.912039,12.645056 4.145997,-5.165872 11.029659,-7.732618 19.343932,-9.798611 7.226085,0.247095 26.299677,-4.234494 29.802645,-3.73626 3.914456,0.660712 4.180543,3.420956 5.089244,5.464663 2.632011,11.17747 3.575642,8.898342 3.933663,16.681192 0.869823,0.425141 3.380174,-5.010027 3.723163,-5.694031 -2.791345,-6.195308 -3.1597,-8.845411 -4.296984,-12.415773 -2.285247,-6.773899 -3.692687,-8.33325 -4.882273,-8.417186 -4.610502,-1.13067 -15.427827,1.077599 -23.37152,1.361003 C 78.557209,16.181413 81.554929,14.30138 88.034137,9.8098031 L 81.373254,7.910908 c 0.591908,-2.2314208 0.352313,-1.9744727 -0.0077,-4.2206411 1.50372,0.563758 3.550121,0.7437886 7.313537,1.6448165 0.267051,0.5161458 0.01185,1.0655961 -0.331621,1.7605477 -0.504038,1.0197985 -0.528664,1.9306548 -0.04164,2.5086355 10.900341,12.9361434 11.380568,22.3843664 15.433313,36.0278094 -1.02876,1.933899 1.45939,-0.688293 2.50851,-1.432801 C 103.73026,28.431204 104.92254,23.068169 91.852684,2.7015868 82.541373,-2.2456717 79.795787,1.9664213 78.296861,3.2483726 z"
       id="path3166"
       sodipodi:nodetypes="ccccccccccccccccccsscccc" />
    <path
       inkscape:connector-curvature="0"
       style="fill:#999999;fill-opacity:1;fill-rule:evenodd;stroke:none;display:inline"
       d="M 89.460244,5.2168028 C 86.66672,6.3027405 83.747706,7.206253 80.35905,7.9351091 l 6.434219,2.6268009 c 0.789686,-0.393091 1.288765,-0.9837241 2.673669,0.316914 l -0.0067,-5.6620212 z"
       id="path3174"
       sodipodi:nodetypes="ccccc" />
    <path
       inkscape:connector-curvature="0"
       style="fill:#808080;fill-opacity:1;fill-rule:evenodd;stroke:none;opacity:0.63636364"
       d="M 56.470514,27.064987 C 49.66143,24.19366 35.66001,35.25244 38.305838,40.080147 c 1.095709,5.077581 0.532104,6.644181 3.967285,12.883597 2.131878,4.903945 3.834577,5.91093 5.420099,10.253482 0.186109,0.509736 1.578427,7.717835 2.193676,9.546441 2.551879,7.584532 4.439191,8.198522 8.568677,18.04195 8.163017,9.506273 5.815991,7.197481 16.556797,9.685443 4.701583,12.20779 8.636101,21.13041 10.869351,30.22552 2.257562,9.1941 3.323028,22.70239 6.827641,37.79828 3.636056,11.86715 5.545045,18.5922 5.480885,18.24974 3.795241,10.416 4.224161,14.11423 11.582371,32.84537 1.25193,1.56458 3.10406,6.93768 5.24465,9.11303 0.6613,9.57191 1.64288,11.73767 2.54135,17.19736 6.90131,11.90874 7.13636,9.28504 13.63973,18.99414 2.37774,7.66385 4.05183,11.67671 6.73171,21.16535 1.37814,2.72564 1.98726,4.57473 3.60801,9.6696 7.97515,9.8512 23.66514,22.51638 25.53148,19.58368 -0.30681,-2.42095 -1.08911,-4.86758 -1.57792,-5.84968 -4.52518,-9.09186 -8.53633,-18.42621 -11.54681,-25.1881 -1.10473,-4.9733 -2.69029,-9.88151 -2.96938,-11.63401 -5.31285,-9.12465 -5.20157,-17.50146 -6.0289,-20.05251 -18.52751,-19.93102 -17.13712,-21.92956 -23.18234,-34.26538 -6.40833,-17.47128 -8.94499,-29.8634 -10.98672,-35.64013 -3.28851,-23.90963 -5.8081,-24.55878 -7.4813,-36.28169 -4.029472,-15.91087 -7.739181,-26.27634 -14.374443,-44.65231 -2.864692,-3.954732 -2.980774,-7.022181 -5.401953,-8.797821 -2.570796,-1.693104 -4.868866,-3.98393 -10.434022,-6.873503 -6.510637,-4.458472 -5.815611,-6.918321 -9.208622,-14.67416 -1.942153,-2.108401 -2.003043,-6.531369 -3.016538,-10.326209 -0.924169,-3.583861 -1.469515,-7.486673 2.197862,-11.984184 -4.048425,-2.854864 -7.012161,-3.652084 -9.890956,-4.601519 -0.555354,7.447879 -3.257843,9.905318 -2.869937,-0.67789 -1.221385,-6.18508 -1.784753,-6.938632 -2.793139,-8.729825 3.704086,-2.147424 6.313665,-3.440373 6.557995,-3.332406 8.743998,5.274229 18.767961,4.996435 30.559742,4.849659 1.336947,0.968837 1.895805,1.266083 3.575311,2.640194 0.863659,1.768381 1.833666,4.908664 2.972725,9.440424 0.380253,4.219311 5.150144,1.414549 4.874204,-2.885689 -3.712879,-4.612687 -1.820338,-6.323053 -5.867342,-13.044746 -2.17231,-1.945687 -3.600122,-1.646121 -8.976215,-1.738556 -7.735767,-0.264112 -12.219995,1.572583 -24.730338,-3.968102 z"
       id="path3186"
       sodipodi:nodetypes="cccssccscccccccccsccccccccccccccccccccccc" />
    <path
       inkscape:connector-curvature="0"
       style="fill:#999999;fill-opacity:1;fill-rule:evenodd;stroke:none;opacity:0.9214876"
       d="m 52.422715,35.169864 c -0.948011,1.447628 -0.308645,0.865033 0.735554,6.962493 1.089493,0.474028 0.990389,-1.236763 1.941419,-0.566922 1.859296,0.977205 5.687636,2.63088 8.834788,5.218258 0.807088,0.513131 0.978935,0.357172 1.066365,1.955901 2.707114,0.395585 3.629618,1.524641 5.902222,3.614645 0.513831,-1.693929 -0.574181,-2.951084 -1.16306,-4.281956 -0.144292,-0.361541 -0.03684,-1.211663 0.329811,-1.796362 C 83.048956,40.840553 82.855547,42.303379 85.800516,42.618843 84.737095,41.009016 83.458159,40.127739 81.9175,39.938835 80.376842,39.749931 78.606241,39.537566 75.328396,39.529482 63.749716,39.363589 61.892494,38.551247 52.422715,35.169864 z"
       id="path3192"
       sodipodi:nodetypes="cccccccccccc" />
  </g>
</svg>
'''

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='Fist your repo')
    parser.add_argument("repopath", help="path to repo")
    args = parser.parse_args()
    gitpath = args.repopath
    if not os.path.isdir(gitpath):
        print >> sys.stderr, "'%s' is not a valid git repo path" % gitpath
    repo = git.Repo(gitpath)
    repo.git.status()
    head = repo.head
    master = head.reference
    log = master.log()
    ll = []
    for l in log:
        m = l.message
        if m.startswith('commit:'):
            ll.append(m.split('commit: ')[1])
    s1 = "|".join(ll)
    temp = tempfile.NamedTemporaryFile(suffix='.svg', delete=False)
    FISTINO = FISTINO.replace('{{s1}}', s1)
    temp.write(FISTINO)
    temp.close()
    subprocess.call(["xdg-open", temp.name])
    #os.unlink(temp.name)